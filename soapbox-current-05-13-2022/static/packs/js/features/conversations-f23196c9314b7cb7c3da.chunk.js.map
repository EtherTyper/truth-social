{"version":3,"file":"packs/js/features/conversations-f23196c9314b7cb7c3da.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/features/conversations/components/conversation.js","webpack://soapbox-fe/./app/soapbox/features/conversations/containers/conversation_container.js","webpack://soapbox-fe/./app/soapbox/features/conversations/components/conversations_list.js","webpack://soapbox-fe/./app/soapbox/features/conversations/containers/conversations_list_container.js","webpack://soapbox-fe/./app/soapbox/features/conversations/index.js"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _class,_class2;import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import{withRouter}from'react-router-dom';import StatusContainer from'../../../containers/status_container';let Conversation=withRouter(_class=(_class2=class Conversation extends ImmutablePureComponent{constructor(){super(...arguments);_defineProperty(this,\"handleClick\",()=>{if(!this.props.history){return;}const{lastStatusId,unread,markRead}=this.props;if(unread){markRead();}this.props.history.push(\"/statuses/\".concat(lastStatusId));});_defineProperty(this,\"handleHotkeyMoveUp\",()=>{this.props.onMoveUp(this.props.conversationId);});_defineProperty(this,\"handleHotkeyMoveDown\",()=>{this.props.onMoveDown(this.props.conversationId);});}render(){const{accounts,lastStatusId,unread}=this.props;if(lastStatusId===null){return null;}return/*#__PURE__*/_jsx(StatusContainer,{id:lastStatusId,unread:unread,otherAccounts:accounts,onMoveUp:this.handleHotkeyMoveUp,onMoveDown:this.handleHotkeyMoveDown,onClick:this.handleClick});}},_defineProperty(_class2,\"propTypes\",{conversationId:PropTypes.string.isRequired,accounts:ImmutablePropTypes.list.isRequired,lastStatusId:PropTypes.string,unread:PropTypes.bool.isRequired,onMoveUp:PropTypes.func,onMoveDown:PropTypes.func,markRead:PropTypes.func.isRequired,history:PropTypes.object}),_class2))||_class;export{Conversation as default};","import{connect}from'react-redux';import{markConversationRead}from'../../../actions/conversations';import Conversation from'../components/conversation';const mapStateToProps=(state,_ref)=>{let{conversationId}=_ref;const conversation=state.getIn(['conversations','items']).find(x=>x.get('id')===conversationId);return{accounts:conversation.get('accounts').map(accountId=>state.getIn(['accounts',accountId],null)),unread:conversation.get('unread'),lastStatusId:conversation.get('last_status',null)};};const mapDispatchToProps=(dispatch,_ref2)=>{let{conversationId}=_ref2;return{markRead:()=>dispatch(markConversationRead(conversationId))};};export default connect(mapStateToProps,mapDispatchToProps)(Conversation);","import _extends from\"@babel/runtime/helpers/esm/extends\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _objectWithoutProperties from\"@babel/runtime/helpers/esm/objectWithoutProperties\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _debounce from\"lodash/debounce\";const _excluded=[\"conversations\",\"isLoading\",\"onLoadMore\"];import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import ScrollableList from'../../../components/scrollable_list';import ConversationContainer from'../containers/conversation_container';export default class ConversationsList extends ImmutablePureComponent{constructor(){super(...arguments);_defineProperty(this,\"getCurrentIndex\",id=>this.props.conversations.findIndex(x=>x.get('id')===id));_defineProperty(this,\"handleMoveUp\",id=>{const elementIndex=this.getCurrentIndex(id)-1;this._selectChild(elementIndex,true);});_defineProperty(this,\"handleMoveDown\",id=>{const elementIndex=this.getCurrentIndex(id)+1;this._selectChild(elementIndex,false);});_defineProperty(this,\"setRef\",c=>{this.node=c;});_defineProperty(this,\"handleLoadOlder\",_debounce(()=>{const maxId=this.props.conversations.getIn([-1,'id']);if(maxId)this.props.onLoadMore(maxId);},300,{leading:true}));}_selectChild(index,align_top){const container=this.node.node;const element=container.querySelector(\"article:nth-of-type(\".concat(index+1,\") .focusable\"));if(element){if(align_top&&container.scrollTop>element.offsetTop){element.scrollIntoView(true);}else if(!align_top&&container.scrollTop+container.clientHeight<element.offsetTop+element.offsetHeight){element.scrollIntoView(false);}element.focus();}}render(){const _this$props=this.props,{conversations,isLoading,onLoadMore}=_this$props,other=_objectWithoutProperties(_this$props,_excluded);return/*#__PURE__*/React.createElement(ScrollableList,_extends({},other,{onLoadMore:onLoadMore&&this.handleLoadOlder,scrollKey:\"direct\",ref:this.setRef,isLoading:isLoading,showLoading:isLoading&&conversations.size===0}),conversations.map(item=>/*#__PURE__*/_jsx(ConversationContainer,{conversationId:item.get('id'),onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown},item.get('id'))));}}_defineProperty(ConversationsList,\"propTypes\",{conversations:ImmutablePropTypes.list.isRequired,hasMore:PropTypes.bool,isLoading:PropTypes.bool,onLoadMore:PropTypes.func});","import{connect}from'react-redux';import{expandConversations}from'../../../actions/conversations';import ConversationsList from'../components/conversations_list';const mapStateToProps=state=>({conversations:state.getIn(['conversations','items']),isLoading:state.getIn(['conversations','isLoading'],true),hasMore:state.getIn(['conversations','hasMore'],false)});const mapDispatchToProps=dispatch=>({onLoadMore:maxId=>dispatch(expandConversations({maxId}))});export default connect(mapStateToProps,mapDispatchToProps)(ConversationsList);","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class;import\"core-js/modules/web.dom-collections.iterator.js\";import React from'react';import{defineMessages,injectIntl,FormattedMessage}from'react-intl';import{connect}from'react-redux';import{directComposeById}from'soapbox/actions/compose';import AccountSearch from'soapbox/components/account_search';import{mountConversations,unmountConversations,expandConversations}from'../../actions/conversations';import{connectDirectStream}from'../../actions/streaming';import{Column}from'../../components/ui';import ConversationsListContainer from'./containers/conversations_list_container';const messages=defineMessages({title:{\"id\":\"column.direct\",\"defaultMessage\":\"Direct messages\"},searchPlaceholder:{\"id\":\"direct.search_placeholder\",\"defaultMessage\":\"Send a message to\\u2026\"}});let ConversationsTimeline=(_dec=connect(),_dec(_class=injectIntl(_class=class ConversationsTimeline extends React.PureComponent{constructor(){super(...arguments);_defineProperty(this,\"handleSuggestion\",accountId=>{this.props.dispatch(directComposeById(accountId));});_defineProperty(this,\"handleLoadMore\",maxId=>{this.props.dispatch(expandConversations({maxId}));});}componentDidMount(){const{dispatch}=this.props;dispatch(mountConversations());dispatch(expandConversations());this.disconnect=dispatch(connectDirectStream());}componentWillUnmount(){this.props.dispatch(unmountConversations());if(this.disconnect){this.disconnect();this.disconnect=null;}}render(){const{intl}=this.props;return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.title)},void 0,/*#__PURE__*/_jsx(AccountSearch,{placeholder:intl.formatMessage(messages.searchPlaceholder),onSelected:this.handleSuggestion}),/*#__PURE__*/_jsx(ConversationsListContainer,{scrollKey:\"direct_timeline\",timelineId:\"direct\",onLoadMore:this.handleLoadMore,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.direct\",defaultMessage:\"You don't have any direct messages yet. When you send or receive one, it will show up here.\"})}));}})||_class)||_class);export{ConversationsTimeline as default};"],"names":["_class","_class2","Conversation","arguments","props","history","lastStatusId","unread","markRead","push","concat","onMoveUp","conversationId","onMoveDown","render","this","accounts","id","otherAccounts","handleHotkeyMoveUp","handleHotkeyMoveDown","onClick","handleClick","state","_ref","conversation","getIn","find","x","get","map","accountId","dispatch","_ref2","_excluded","conversations","findIndex","elementIndex","getCurrentIndex","_selectChild","c","node","maxId","onLoadMore","leading","index","align_top","container","element","querySelector","scrollTop","offsetTop","scrollIntoView","clientHeight","offsetHeight","focus","_this$props","isLoading","other","handleLoadOlder","scrollKey","ref","setRef","showLoading","size","item","handleMoveUp","handleMoveDown","ConversationsList","hasMore","messages","title","searchPlaceholder","ConversationsTimeline","_dec","injectIntl","componentDidMount","disconnect","componentWillUnmount","intl","label","formatMessage","placeholder","onSelected","handleSuggestion","timelineId","handleLoadMore","emptyMessage","defaultMessage"],"sourceRoot":""}