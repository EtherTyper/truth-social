{"version":3,"file":"packs/js/features/remote_timeline-a46dbf69ed25c793b2eb.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/features/remote_timeline/index.tsx","webpack://soapbox-fe/./app/soapbox/actions/remote_timeline.js","webpack://soapbox-fe/./app/soapbox/features/ui/components/instance_info_panel.tsx","webpack://soapbox-fe/./app/soapbox/features/ui/components/instance_moderation_panel.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React,{useEffect,useRef}from'react';import{defineMessages,useIntl,FormattedMessage}from'react-intl';import{useHistory}from'react-router-dom';import IconButton from'soapbox/components/icon_button';import Column from'soapbox/features/ui/components/column';import{useAppDispatch,useSettings}from'soapbox/hooks';import{connectRemoteStream}from'../../actions/streaming';import{expandRemoteTimeline}from'../../actions/timelines';import StatusListContainer from'../ui/containers/status_list_container';import PinnedHostsPicker from'./components/pinned_hosts_picker';const messages=defineMessages({title:{\"id\":\"column.remote\",\"defaultMessage\":\"Federated timeline\"}});/** View statuses from a remote instance. */const RemoteTimeline=_ref=>{let{params}=_ref;const intl=useIntl();const history=useHistory();const dispatch=useAppDispatch();const instance=params===null||params===void 0?void 0:params.instance;const settings=useSettings();const stream=useRef(null);const timelineId='remote';const onlyMedia=!!settings.getIn(['remote','other','onlyMedia']);const pinned=settings.getIn(['remote_timeline','pinnedHosts']).includes(instance);const disconnect=()=>{if(stream.current){stream.current();}};const handleCloseClick=()=>{history.push('/timeline/fediverse');};const handleLoadMore=maxId=>{dispatch(expandRemoteTimeline(instance,{maxId,onlyMedia}));};useEffect(()=>{disconnect();dispatch(expandRemoteTimeline(instance,{onlyMedia,maxId:undefined}));stream.current=dispatch(connectRemoteStream(instance,{onlyMedia}));return()=>{disconnect();stream.current=null;};},[onlyMedia]);return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.title),heading:instance,transparent:true},void 0,instance&&/*#__PURE__*/_jsx(PinnedHostsPicker,{host:instance}),!pinned&&/*#__PURE__*/_jsx(\"div\",{className:\"timeline-filter-message\"},void 0,/*#__PURE__*/_jsx(IconButton,{src:require('@tabler/icons/icons/x.svg'),onClick:handleCloseClick}),/*#__PURE__*/_jsx(FormattedMessage,{id:\"remote_timeline.filter_message\",defaultMessage:\"You are viewing the timeline of {instance}.\",values:{instance}})),/*#__PURE__*/_jsx(StatusListContainer,{scrollKey:\"\".concat(timelineId,\"_\").concat(instance,\"_timeline\"),timelineId:\"\".concat(timelineId).concat(onlyMedia?':media':'',\":\").concat(instance),onLoadMore:handleLoadMore,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.remote\",defaultMessage:\"There is nothing here! Manually follow users from {instance} to fill it up.\",values:{instance}}),divideType:\"space\"}));};export default RemoteTimeline;","import{getSettings,changeSetting}from'soapbox/actions/settings';const getPinnedHosts=state=>{const settings=getSettings(state);return settings.getIn(['remote_timeline','pinnedHosts']);};export function pinHost(host){return(dispatch,getState)=>{const state=getState();const pinnedHosts=getPinnedHosts(state);return dispatch(changeSetting(['remote_timeline','pinnedHosts'],pinnedHosts.add(host)));};}export function unpinHost(host){return(dispatch,getState)=>{const state=getState();const pinnedHosts=getPinnedHosts(state);return dispatch(changeSetting(['remote_timeline','pinnedHosts'],pinnedHosts.delete(host)));};}","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{useIntl,defineMessages}from'react-intl';import{pinHost,unpinHost}from'soapbox/actions/remote_timeline';import DropdownMenu from'soapbox/containers/dropdown_menu_container';import{useAppSelector,useAppDispatch,useSettings}from'soapbox/hooks';import{makeGetRemoteInstance}from'soapbox/selectors';const getRemoteInstance=makeGetRemoteInstance();const messages=defineMessages({pinHost:{\"id\":\"remote_instance.pin_host\",\"defaultMessage\":\"Pin {host}\"},unpinHost:{\"id\":\"remote_instance.unpin_host\",\"defaultMessage\":\"Unpin {host}\"}});/** Widget that displays information about a remote instance to users. */const InstanceInfoPanel=_ref=>{let{host}=_ref;const intl=useIntl();const dispatch=useAppDispatch();const settings=useSettings();const remoteInstance=useAppSelector(state=>getRemoteInstance(state,host));const pinned=settings.getIn(['remote_timeline','pinnedHosts']).includes(host);const handlePinHost=()=>{if(!pinned){dispatch(pinHost(host));}else{dispatch(unpinHost(host));}};const makeMenu=()=>{return[{text:intl.formatMessage(pinned?messages.unpinHost:messages.pinHost,{host}),action:handlePinHost,icon:require(pinned?'@tabler/icons/icons/pinned-off.svg':'@tabler/icons/icons/pin.svg')}];};const menu=makeMenu();const icon=pinned?'thumbtack':'globe-w';if(!remoteInstance)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel instance-federation-panel\"},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel-header\"},void 0,/*#__PURE__*/_jsx(\"i\",{role:\"img\",className:\"fa fa-\".concat(icon,\" wtf-panel-header__icon\")}),/*#__PURE__*/_jsx(\"span\",{className:\"wtf-panel-header__label\"},void 0,/*#__PURE__*/_jsx(\"span\",{},void 0,remoteInstance.get('host'))),/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel__menu\"},void 0,/*#__PURE__*/_jsx(DropdownMenu,{items:menu,src:require('@tabler/icons/icons/dots-vertical.svg')}))));};export default InstanceInfoPanel;","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{useIntl,defineMessages,FormattedMessage}from'react-intl';import{openModal}from'soapbox/actions/modals';import DropdownMenu from'soapbox/containers/dropdown_menu_container';import InstanceRestrictions from'soapbox/features/federation_restrictions/components/instance_restrictions';import{useAppSelector,useAppDispatch,useOwnAccount}from'soapbox/hooks';import{makeGetRemoteInstance}from'soapbox/selectors';const getRemoteInstance=makeGetRemoteInstance();const messages=defineMessages({editFederation:{\"id\":\"remote_instance.edit_federation\",\"defaultMessage\":\"Edit federation\"}});/** Widget for moderators to manage a remote instance. */const InstanceModerationPanel=_ref=>{let{host}=_ref;const intl=useIntl();const dispatch=useAppDispatch();const account=useOwnAccount();const remoteInstance=useAppSelector(state=>getRemoteInstance(state,host));const handleEditFederation=()=>{dispatch(openModal('EDIT_FEDERATION',{host}));};const makeMenu=()=>{return[{text:intl.formatMessage(messages.editFederation),action:handleEditFederation,icon:require('@tabler/icons/icons/edit.svg')}];};const menu=makeMenu();return/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel instance-federation-panel\"},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel-header\"},void 0,/*#__PURE__*/_jsx(\"i\",{role:\"img\",className:\"fa fa-gavel wtf-panel-header__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"wtf-panel-header__label\"},void 0,/*#__PURE__*/_jsx(\"span\",{},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"remote_instance.federation_panel.heading\",defaultMessage:\"Federation Restrictions\"}))),(account===null||account===void 0?void 0:account.admin)&&/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel__menu\"},void 0,/*#__PURE__*/_jsx(DropdownMenu,{items:menu,src:require('@tabler/icons/icons/dots-vertical.svg')}))),/*#__PURE__*/_jsx(\"div\",{className:\"wtf-panel__content\"},void 0,/*#__PURE__*/_jsx(InstanceRestrictions,{remoteInstance:remoteInstance})));};export default InstanceModerationPanel;"],"names":["messages","title","_ref","params","intl","history","dispatch","instance","settings","stream","useRef","timelineId","onlyMedia","getIn","pinned","includes","disconnect","current","useEffect","maxId","undefined","label","formatMessage","heading","transparent","host","className","src","onClick","push","id","defaultMessage","values","scrollKey","concat","onLoadMore","emptyMessage","divideType","getPinnedHosts","state","getRemoteInstance","pinHost","unpinHost","useIntl","remoteInstance","menu","text","action","getState","pinnedHosts","delete","add","icon","role","get","items","editFederation","account","admin"],"sourceRoot":""}