"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[32],{1080:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var i=a(1821),o=a(1814),l=(a(1),a(32),a(0)),s=a(1815),r=a(583),n=a(1827),d=a(16),c=a(42),f=a(17),u=a(365),h=a(4),p=a(65),g=a(317),v=a(2),b=a(498),_=a(154),m=a(194),Z=function(e){var t=e.account,a=(0,h.Dn)().displayFqn;return(0,i.Z)("div",{className:"bg-white dark:bg-slate-800 rounded-lg text-black dark:text-white sm:shadow dark:sm:shadow-inset overflow-hidden"},void 0,(0,i.Z)("div",{},void 0,(0,i.Z)("div",{className:"relative w-full h-32 md:rounded-t-lg bg-gray-200 dark:bg-slate-900/50"},void 0,(0,i.Z)(_.Z,{alt:"",src:t.header,className:"absolute inset-0 object-cover md:rounded-t-lg"}))),(0,i.Z)(v.Ug,{space:3,alignItems:"center",className:"p-3"},void 0,(0,i.Z)("div",{className:"relative"},void 0,(0,i.Z)("div",{className:"h-12 w-12 bg-gray-400 rounded-full"},void 0,(0,i.Z)(_.Z,{alt:"",className:"h-12 w-12 rounded-full",src:t.avatar})),!t.verified&&(0,i.Z)("div",{className:"absolute -top-1.5 -right-1.5"},void 0,(0,i.Z)(m.Z,{}))),(0,i.Z)(v.Kq,{className:"truncate"},void 0,(0,i.Z)(v.xv,{weight:"medium",size:"sm",truncate:!0},void 0,t.display_name),(0,i.Z)(v.xv,{theme:"muted",size:"sm"},void 0,"@",a?t.fqn:t.acct))))},w=function(e,t,a){if(a||2===arguments.length)for(var i,o=0,l=t.length;o<l;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))};function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,o.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k,x=function(e){var t=e.pleroma.toJS(),a=t.hide_followers,i=t.hide_follows,o=t.hide_followers_count,l=t.hide_follows_count;return Boolean(a&&i&&o&&l)},P=(k=function(e){return function(t){return t((function(a){return e(e)(t)(a)}))}})(k)((function(e){return function(t){return function(a){return function(i){return i instanceof Object&&Object.keys(i).forEach((function(o){var l=i[o];if(a&&(o="".concat(a,"[").concat(o,"]")),!(!(l instanceof Object)||l instanceof Date||l instanceof File))return e(t)(o)(l);t.append(o,l)})),t}}}}))(new FormData)(),C=(0,s.vU)({heading:{id:"column.edit_profile",defaultMessage:"Edit profile"},header:{id:"edit_profile.header",defaultMessage:"Edit Profile"},metaFieldLabel:{id:"edit_profile.fields.meta_fields.label_placeholder",defaultMessage:"Label"},metaFieldContent:{id:"edit_profile.fields.meta_fields.content_placeholder",defaultMessage:"Content"},success:{id:"edit_profile.success",defaultMessage:"Profile saved!"},error:{id:"edit_profile.error",defaultMessage:"Profile update failed"},bioPlaceholder:{id:"edit_profile.fields.bio_placeholder",defaultMessage:"Tell us about yourself."},displayNamePlaceholder:{id:"edit_profile.fields.display_name_placeholder",defaultMessage:"Name"},websitePlaceholder:{id:"edit_profile.fields.website_placeholder",defaultMessage:"Display a Link"},locationPlaceholder:{id:"edit_profile.fields.location_placeholder",defaultMessage:"Location"},cancel:{id:"common.cancel",defaultMessage:"Cancel"}}),O=function(e){var t=e.value,a=e.onChange,o=(0,r.Z)(),l=function(e){return function(i){var o;a(M(M({},t),{},((o={})[e]=i.currentTarget.value,o)))}};return(0,i.Z)(v.Ug,{space:2,grow:!0},void 0,(0,i.Z)(v.II,{type:"text",outerClassName:"w-2/5 flex-grow",value:t.name,onChange:l("name"),placeholder:o.formatMessage(C.metaFieldLabel)}),(0,i.Z)(v.II,{type:"text",outerClassName:"w-3/5 flex-grow",value:t.value,onChange:l("value"),placeholder:o.formatMessage(C.metaFieldContent)}))},I=function(){var e=(0,r.Z)(),t=(0,h.TL)(),a=(0,h.Tr)(),o=(0,h.hz)(),s=(0,h.CG)((function(e){return e.instance.pleroma.getIn(["metadata","fields_limits","max_fields"],4)})),_=(0,l.useState)(!1),m=_[0],y=_[1],k=(0,l.useState)({}),I=k[0],N=k[1],D=(0,l.useState)(!1),j=D[0],T=D[1];(0,l.useEffect)((function(){if(a){var e=function(e){var t=x(e);return{discoverable:e.discoverable,bot:e.bot,display_name:e.display_name,note:e.source.get("note"),locked:e.locked,fields_attributes:w([],e.source.get("fields",[]).toJS(),!0),stranger_notifications:!0===e.getIn(["pleroma","notification_settings","block_from_strangers"]),accepts_email_list:!0===e.getIn(["pleroma","accepts_email_list"]),hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t,website:e.website,location:e.location,birthday:e.birthday}}(a),t=!0===a.getIn(["pleroma","notification_settings","block_from_strangers"]);N(e),T(t)}}),[null==a?void 0:a.id]);var L=function(e,t){N((function(a){var i;return M(M({},a),{},((i={})[e]=t,i))}))},S=function(e){return function(t){L(e,t.target.checked)}},F=function(e){return function(t){L(e,t.target.value)}},z=function(e,t){return function(a){var i,o=null===(i=a.target.files)||void 0===i?void 0:i.item(0);o&&(0,g.Z)(o,t).then((function(t){L(e,t)})).catch(console.error)}},U=(0,l.useMemo)((function(){return I.avatar?URL.createObjectURL(I.avatar):null==a?void 0:a.avatar}),[I.avatar,null==a?void 0:a.avatar]),G=(0,l.useMemo)((function(){return I.header?URL.createObjectURL(I.header):null==a?void 0:a.header}),[I.header,null==a?void 0:a.header]),H=(0,l.useMemo)((function(){return(0,p.WT)(M(M(M({},null==a?void 0:a.toJS()),I),{},{avatar:U,header:G}))}),[null==a?void 0:a.id,I.display_name,U,G]);return(0,i.Z)(v.sg,{label:e.formatMessage(C.header)},void 0,(0,i.Z)(v.l0,{onSubmit:function(a){var i=[],l=P(I);i.push(t((0,c.sQ)(l))),o.muteStrangers&&i.push(t((0,d.lU)({block_from_strangers:j})).catch(console.error)),y(!0),Promise.all(i).then((function(){y(!1),t(f.ZP.success(e.formatMessage(C.success)))})).catch((function(){y(!1),t(f.ZP.error(e.formatMessage(C.error)))})),a.preventDefault()}},void 0,(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.display_name_label",defaultMessage:"Display name"})},void 0,(0,i.Z)(v.II,{type:"text",value:I.display_name,onChange:F("display_name"),placeholder:e.formatMessage(C.displayNamePlaceholder)})),o.birthdays&&(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.birthday_label",defaultMessage:"Birthday"})},void 0,(0,i.Z)(v.II,{type:"text",value:I.birthday,onChange:F("birthday")})),o.accountLocation&&(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.location_label",defaultMessage:"Location"})},void 0,(0,i.Z)(v.II,{type:"text",value:I.location,onChange:F("location"),placeholder:e.formatMessage(C.locationPlaceholder)})),o.accountWebsite&&(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.website_label",defaultMessage:"Website"})},void 0,(0,i.Z)(v.II,{type:"text",value:I.website,onChange:F("website"),placeholder:e.formatMessage(C.websitePlaceholder)})),(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.bio_label",defaultMessage:"Bio"})},void 0,(0,i.Z)(v.gx,{value:I.note,onChange:F("note"),autoComplete:"off",placeholder:e.formatMessage(C.bioPlaceholder)})),(0,i.Z)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},void 0,(0,i.Z)(Z,{account:H}),(0,i.Z)("div",{className:"space-y-4"},void 0,(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.header_label",defaultMessage:"Choose Background Picture"}),hintText:(0,i.Z)(n.Z,{id:"edit_profile.hints.header",defaultMessage:"PNG, GIF or JPG. Will be downscaled to {size}",values:{size:"1920x1080px"}})},void 0,(0,i.Z)("input",{type:"file",onChange:z("header",2073600),className:"text-sm"})),(0,i.Z)(v.cw,{labelText:(0,i.Z)(n.Z,{id:"edit_profile.fields.avatar_label",defaultMessage:"Choose Profile Picture"}),hintText:(0,i.Z)(n.Z,{id:"edit_profile.hints.avatar",defaultMessage:"PNG, GIF or JPG. Will be downscaled to {size}",values:{size:"400x400px"}})},void 0,(0,i.Z)("input",{type:"file",onChange:z("avatar",16e4),className:"text-sm"})))),(0,i.Z)(u.Z,{},void 0,o.followRequests&&(0,i.Z)(u.H,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.locked_label",defaultMessage:"Lock account"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.locked",defaultMessage:"Requires you to manually approve followers"})},void 0,(0,i.Z)(v.ZD,{checked:I.locked,onChange:S("locked")})),o.hideNetwork&&(0,i.Z)(u.H,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.hide_network_label",defaultMessage:"Hide network"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.hide_network",defaultMessage:"Who you follow and who follows you will not be shown on your profile"})},void 0,(0,i.Z)(v.ZD,{checked:!!a&&x(a),onChange:function(e){var t=e.target.checked;N((function(e){return M(M({},e),{},{hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t})}))}})),o.bots&&(0,i.Z)(u.H,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.bot_label",defaultMessage:"This is a bot account"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.bot",defaultMessage:"This account mainly performs automated actions and might not be monitored"})},void 0,(0,i.Z)(v.ZD,{checked:I.bot,onChange:S("bot")})),o.muteStrangers&&(0,i.Z)(u.H,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.stranger_notifications_label",defaultMessage:"Block notifications from strangers"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.stranger_notifications",defaultMessage:"Only show notifications from people you follow"})},void 0,(0,i.Z)(v.ZD,{checked:j,onChange:function(e){return T(e.target.checked)}})),o.profileDirectory&&(0,i.Z)(u.H,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.discoverable_label",defaultMessage:"Allow account discovery"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.discoverable",defaultMessage:"Display account in profile directory and allow indexing by external services"})},void 0,(0,i.Z)(v.ZD,{checked:I.discoverable,onChange:S("discoverable")})),o.emailList&&(0,i.Z)(u.H,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.accepts_email_list_label",defaultMessage:"Subscribe to newsletter"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.accepts_email_list",defaultMessage:"Opt-in to news and marketing updates."})},void 0,(0,i.Z)(v.ZD,{checked:I.accepts_email_list,onChange:S("accepts_email_list")}))),o.profileFields&&(0,i.Z)(b.Z,{label:(0,i.Z)(n.Z,{id:"edit_profile.fields.meta_fields_label",defaultMessage:"Profile fields"}),hint:(0,i.Z)(n.Z,{id:"edit_profile.hints.meta_fields",defaultMessage:"You can have up to {count, plural, one {# custom field} other {# custom fields}} displayed on your profile.",values:{count:s}}),values:I.fields_attributes||[],onChange:function(e){L("fields_attributes",e)},onAddItem:function(){var e=I.fields_attributes||[],t=w(w([],e,!0),[{name:"",value:""}],!1);L("fields_attributes",t)},onRemoveItem:function(e){var t=I.fields_attributes||[],a=w([],t,!0);a.splice(e,1),L("fields_attributes",a)},component:O,maxItems:s}),(0,i.Z)(v.iN,{},void 0,(0,i.Z)(v.zx,{to:"/settings",theme:"ghost"},void 0,e.formatMessage(C.cancel)),(0,i.Z)(v.zx,{theme:"primary",type:"submit",disabled:m},void 0,(0,i.Z)(n.Z,{id:"edit_profile.save",defaultMessage:"Save"})))))}}}]);
//# sourceMappingURL=edit_profile-a11e87c71f4719da6e24.chunk.js.map