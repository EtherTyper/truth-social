"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[20],{1091:function(t,n,e){e.r(n),e.d(n,{default:function(){return z}});var o,a,i,r,c,s=e(1821),u=e(1814),d=(e(1),e(602)),p=e(5),l=e.n(p),h=e(0),f=e(10),g=e.n(f),Z=e(8),v=e(1827),_=e(1815),w=e(584),m=e(3),y=e(1811),C=e(47),b=e(43),S=e(12),I=e(264),N=e(499),P=e(1820),j=e(961),k=e(970),q=e(40),O=e(193),R=e(34),x=e(11),T=e(38),E=e(64),W=e(946),M=(o=function(t,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},o(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),F=(0,m.$j)((function(){var t=(0,x.dq)();return function(n,e){var o=e.chatId,a=n.getIn(["chats","items",o]);return{me:n.get("me"),chat:a?t(n,a.toJS()):void 0,displayFqn:(0,E.$X)(n)}}}))(a=(0,w.ZP)((i=function(t){function n(){var n=t.apply(this,arguments)||this;return(0,u.Z)(n,"state",{content:""}),(0,u.Z)(n,"handleChatClose",(function(t){return function(e){n.props.dispatch((0,b.wt)(t))}})),(0,u.Z)(n,"handleChatToggle",(function(t){return function(e){n.props.dispatch((0,b.w2)(t))}})),(0,u.Z)(n,"handleContentChange",(function(t){n.setState({content:t.target.value})})),(0,u.Z)(n,"handleInputRef",(function(t){n.inputElem=t,n.focusInput()})),(0,u.Z)(n,"focusInput",(function(){n.inputElem&&n.inputElem.focus()})),n}return M(n,t),n.prototype.componentDidUpdate=function(t){var n=t.windowState,e=this.props.windowState;n!==e&&"open"===e&&this.focusInput()},n.prototype.render=function(){var t=this.props,n=t.windowState,o=t.idx,a=t.chat,i=t.displayFqn;if(!a)return null;var r=a.get("account"),c=285*(o+1)+20,u=a.get("unread"),d=(0,s.Z)("i",{className:"icon-with-badge__badge"},void 0,(0,P.w8)(u)),p=(0,s.Z)(O.ZP,{accountId:r.get("id")},void 0,(0,s.Z)(k.rU,{to:"/@".concat(r.get("acct"))},void 0,(0,s.Z)(q.Z,{account:r,size:18})));return(0,s.Z)("div",{className:"pane pane--".concat(n),style:{right:"".concat(c,"px")}},void 0,(0,s.Z)("div",{className:"pane__header"},void 0,u>0?d:p,(0,s.Z)("button",{className:"pane__title",onClick:this.handleChatToggle(a.get("id"))},void 0,"@",(0,T.F7)(r,i)),(0,s.Z)("div",{className:"pane__close"},void 0,(0,s.Z)(R.Z,{src:e(26),title:"Close chat",onClick:this.handleChatClose(a.get("id"))}))),(0,s.Z)("div",{className:"pane__content"},void 0,(0,s.Z)(W.Z,{chatId:a.get("id"),onSetInputRef:this.handleInputRef})))},n}(Z.ZP),(0,u.Z)(i,"propTypes",{dispatch:l().func.isRequired,intl:l().object.isRequired,chatId:l().string.isRequired,windowState:l().string.isRequired,idx:l().number,chat:g().record,me:l().node,displayFqn:l().bool}),a=i))||a)||a,U=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),$=(0,_.vU)({searchPlaceholder:{id:"chats.search_placeholder",defaultMessage:"Start a chat withâ€¦"}}),A=function(t){return t.getIn(["chats","items"]).reduce((function(t,n){return t+Math.min(n.get("unread",0),1)}),0)},G=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,d.List)();return n.filter((function(n){return t.get(n.get("chat_id"))}))},z=(0,m.$j)((function(){return function(t){var n=(0,C.P1)([function(t){return t.getIn(["chats","items"])},function(t){return(0,S.Gw)(t).getIn(["chats","panes"])}],G);return{panes:n(t),mainWindowState:(0,S.Gw)(t).getIn(["chats","mainWindow"]),unreadCount:A(t)}}}))(r=(0,w.ZP)(r=(0,y.EN)((c=function(t){function n(){var n=t.apply(this,arguments)||this;return(0,u.Z)(n,"handleClickChat",(function(t){n.props.dispatch((0,b.WB)(t.get("id")))})),(0,u.Z)(n,"handleSuggestion",(function(t){n.props.dispatch((0,b.aU)(t,n.props.history))})),(0,u.Z)(n,"handleMainWindowToggle",(function(){n.props.dispatch((0,b.wv)())})),n}return U(n,t),n.prototype.render=function(){var t=this.props,n=t.intl,e=t.panes,o=t.mainWindowState,a=t.unreadCount,i="open"===o,r=(0,s.Z)("div",{className:"pane pane--main pane--".concat(o)},void 0,(0,s.Z)("div",{className:"pane__header"},void 0,a>0&&(0,s.Z)("i",{className:"icon-with-badge__badge"},void 0,(0,P.w8)(a)),(0,s.Z)("button",{className:"pane__title",onClick:this.handleMainWindowToggle},void 0,(0,s.Z)(v.Z,{id:"chat_panels.main_window.title",defaultMessage:"Chats"})),(0,s.Z)(N.Z,{})),(0,s.Z)("div",{className:"pane__content"},void 0,i&&h.createElement(h.Fragment,null,(0,s.Z)(j.Z,{onClickChat:this.handleClickChat}),(0,s.Z)(I.Z,{placeholder:n.formatMessage($.searchPlaceholder),onSelected:this.handleSuggestion}))));return(0,s.Z)("div",{className:"chat-panes"},void 0,r,e.map((function(t,n){return(0,s.Z)(F,{idx:n,chatId:t.get("chat_id"),windowState:t.get("state")},t.get("chat_id"))})))},n}(Z.ZP),(0,u.Z)(c,"propTypes",{intl:l().object.isRequired,dispatch:l().func.isRequired,mainWindowState:l().string,panes:g().list,history:l().object}),r=c))||r)||r)||r}}]);
//# sourceMappingURL=chat_panes-8ddddc0e67d90b53a5c0.chunk.js.map