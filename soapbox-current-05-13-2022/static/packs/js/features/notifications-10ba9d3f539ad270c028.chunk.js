"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[56],{1026:function(t,e,o){o.r(e),o.d(e,{default:function(){return it}});var n,i,a=o(1814),s=o(1810),r=o(1823),c=o(1821),l=o(22),u=o.n(l),f=(o(1),o(602)),d=o(0),p=o(1815),m=o(584),h=o(1827),g=o(3),v=o(950),Z=o(47),y=o(12),M=o(323),b=o(118),w=o(1852),_=o(1851),x=function(){return(0,c.Z)("div",{className:"bg-white dark:bg-slate-800 px-4 py-6 sm:p-6"},void 0,(0,c.Z)("div",{className:"w-full animate-pulse"},void 0,(0,c.Z)("div",{className:"mb-2"},void 0,(0,c.Z)(_.Z,{minLength:20,maxLength:20})),(0,c.Z)("div",{},void 0,(0,c.Z)("div",{className:"flex space-x-3 items-center"},void 0,(0,c.Z)("div",{className:"flex-shrink-0"},void 0,(0,c.Z)(b.Z,{size:48})),(0,c.Z)("div",{className:"min-w-0 flex-1"},void 0,(0,c.Z)(w.Z,{minLength:3,maxLength:25})))),(0,c.Z)("div",{className:"mt-4"},void 0,(0,c.Z)(_.Z,{minLength:5,maxLength:120}))))},j=d.memo(x),k=o(275),C=o(1853),N=o(2),I=o(14),S=o(15),T=(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),P=(0,p.vU)({all:{id:"notifications.filter.all",defaultMessage:"All"},mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Likes"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Reposts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},moves:{id:"notifications.filter.moves",defaultMessage:"Moves"},emoji_reacts:{id:"notifications.filter.emoji_reacts",defaultMessage:"Emoji reacts"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}}),q=(0,m.ZP)(i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.onClick=function(t){var e=this;return function(){return e.props.selectFilter(t)}},e.prototype.render=function(){var t=this.props,e=t.selectedFilter,n=t.advancedMode,i=t.supportsEmojiReacts,a=t.intl,s=[{text:a.formatMessage(P.all),action:this.onClick("all"),name:"all"}];return n?(s.push({text:(0,c.Z)(S.Z,{src:o(192)}),title:a.formatMessage(P.mentions),action:this.onClick("mention"),name:"mention"}),s.push({text:(0,c.Z)(S.Z,{src:o(1332)}),title:a.formatMessage(P.favourites),action:this.onClick("favourite"),name:"favourite"}),i&&s.push({text:(0,c.Z)(S.Z,{src:o(1333)}),title:a.formatMessage(P.emoji_reacts),action:this.onClick("pleroma:emoji_reaction"),name:"pleroma:emoji_reaction"}),s.push({text:(0,c.Z)(S.Z,{src:o(1334)}),title:a.formatMessage(P.boosts),action:this.onClick("reblog"),name:"reblog"}),s.push({text:(0,c.Z)(S.Z,{src:o(746)}),title:a.formatMessage(P.polls),action:this.onClick("poll"),name:"poll"}),s.push({text:(0,c.Z)(S.Z,{src:o(716)}),title:a.formatMessage(P.statuses),action:this.onClick("status"),name:"status"}),s.push({text:(0,c.Z)(S.Z,{src:o(503)}),title:a.formatMessage(P.follows),action:this.onClick("follow"),name:"follow"}),s.push({text:(0,c.Z)(S.Z,{src:o(909)}),title:a.formatMessage(P.moves),action:this.onClick("move"),name:"move"})):s.push({text:a.formatMessage(P.mentions),action:this.onClick("mention"),name:"mention"}),(0,c.Z)(N.mQ,{items:s,activeItem:e})},e}(d.PureComponent))||i,L=(0,g.$j)((function(t){var e=(0,y.Gw)(t),o=t.get("instance"),n=(0,I.N$)(o);return{selectedFilter:e.getIn(["notifications","quickFilter","active"]),advancedMode:e.getIn(["notifications","quickFilter","advanced"]),supportsEmojiReacts:n.emojiReacts}}),(function(t){return{selectFilter:function(e){t((0,k.Tv)(e))}}}))(q),O=o(20),R=o(67),F=o(1828),D=o(50),U=o(11),E=o(318),H=o(583),G=o(1811),A=o(281),W=o(23),B=o(227),z=function(t,e,o){var n=[e];return n.push(t.formatDate(o,{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"})),n.join(", ")};function Q(t){return d.createElement(h.Z,t)}var $,K={follow:o(503),follow_request:o(503),mention:o(192),favourite:o(198),reblog:o(59),status:o(1335),poll:o(746),move:o(416),"pleroma:chat_mention":o(248),"pleroma:emoji_reaction":o(904)},V={follow:{id:"notification.follow",defaultMessage:"{name} followed you"},follow_request:{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you"},mention:{id:"notification.mentioned",defaultMessage:"{name} mentioned you"},favourite:{id:"notification.favourite",defaultMessage:"{name} liked your post"},reblog:{id:"notification.reblog",defaultMessage:"{name} reposted your post"},status:{id:"notification.status",defaultMessage:"{name} just posted"},poll:{id:"notification.poll",defaultMessage:"A poll you have voted in has ended"},move:{id:"notification.move",defaultMessage:"{name} moved to {targetName}"},"pleroma:chat_mention":{id:"notification.chat_mention",defaultMessage:"{name} sent you a message"},"pleroma:emoji_reaction":{id:"notification.pleroma:emoji_reaction",defaultMessage:"{name} reacted to your post"}},J=(0,g.$j)((function(){var t=(0,U.e4)();return function(e,o){return{siteTitle:e.getIn(["instance","title"]),notification:t(e,o.notification)}}}),(function(t){return{onMention:function(e,o){t((0,O.Ck)(e,o))},onModalReblog:function(e){t((0,R.UM)(e))},onReblog:function(e,o){var n=this;t((function(i,a){var s=(0,y.Gw)(a()).get("boostModal");e.get("reblogged")?t((0,R.y_)(e)):o.shiftKey||!s?n.onModalReblog(e):t((0,F.h7)("BOOST",{status:e,onReblog:n.onModalReblog}))}))},onFavourite:function(e){e.get("favourited")?t((0,R.m9)(e)):t((0,R.yF)(e))},onToggleHidden:function(e){e.get("hidden")?t((0,D.oK)(e.get("id"))):t((0,D.E1)(e.get("id")))}}}))((function(t){var e=t.hidden,o=void 0!==e&&e,n=t.notification,i=t.onMoveUp,a=t.onMoveDown,s=(0,G.k6)(),r=(0,H.Z)(),l=n.type,u=n.account,f=n.status,d=function(){u&&"object"==typeof u&&s.push("/@".concat(u.acct))},p=function(e){null==e||e.preventDefault(),u&&"object"==typeof u&&t.onMention(u,s)},m=function(){i(n.id)},h=function(){a(n.id)},g=n.target&&"object"==typeof n.target?n.target.acct:"",v=l&&u&&"object"==typeof u?function(t,e,o){var n=function(t){return(0,c.Z)("bdi",{},void 0,(0,c.Z)(A.Z,{className:"text-gray-800 dark:text-gray-200 font-bold hover:underline",href:"/@".concat(t.acct),title:t.acct,to:"/@".concat(t.acct),dangerouslySetInnerHTML:{__html:t.display_name_html}}))}(e);return(0,c.Z)(Q,{id:V[t].id,defaultMessage:V[t].defaultMessage,values:{name:n,targetName:o}})}(l,u,g):null;return(0,c.Z)(E.HotKeys,{handlers:{reply:p,favourite:function(e){f&&"object"==typeof f&&t.onFavourite(f)},boost:function(e){f&&"object"==typeof f&&t.onReblog(f,e)},mention:p,open:function(){f&&"object"==typeof f&&u&&"object"==typeof u?s.push("/@".concat(u.acct,"/posts/").concat(f.id)):d()},openProfile:d,moveUp:m,moveDown:h,toggleHidden:function(e){f&&"object"==typeof f&&t.onToggleHidden(f)}},"data-testid":"notification"},void 0,(0,c.Z)("div",{className:"notification focusable",tabIndex:0,"aria-label":z(r,r.formatMessage({id:l&&V[l].id,defaultMessage:l&&V[l].defaultMessage},{name:u&&"object"==typeof u?u.acct:"",targetName:g}),n.created_at)},void 0,(0,c.Z)("div",{className:"p-4 focusable"},void 0,(0,c.Z)("div",{className:"mb-2"},void 0,(0,c.Z)(N.Ug,{alignItems:"center",space:1.5},void 0,"pleroma:emoji_reaction"===l&&n.emoji?(0,c.Z)(N.dy,{emoji:n.emoji,className:"w-4 h-4 flex-none"}):l?(0,c.Z)(S.Z,{src:K[l],className:"text-primary-600 dark:text-primary-400 flex-none"}):null,(0,c.Z)("div",{className:"truncate"},void 0,(0,c.Z)(N.xv,{theme:"muted",size:"sm",truncate:!0},void 0,v)))),(0,c.Z)("div",{},void 0,function(){switch(l){case"follow":case"follow_request":return u&&"object"==typeof u?(0,c.Z)(W.Z,{id:u.id,hidden:o,avatarSize:48}):null;case"move":return u&&"object"==typeof u&&n.target&&"object"==typeof n.target?(0,c.Z)(W.Z,{id:n.target.id,hidden:o,avatarSize:48}):null;case"favourite":case"mention":case"reblog":case"status":case"poll":case"pleroma:emoji_reaction":return f&&"object"==typeof f?(0,c.Z)(B.Z,{id:f.id,withDismiss:!0,hidden:o,onMoveDown:h,onMoveUp:m,contextType:"notifications",getScrollPosition:t.getScrollPosition,updateScrollBottom:t.updateScrollBottom,cachedMediaWidth:t.cachedMediaWidth,cacheMediaWidth:t.cacheMediaWidth}):null;default:return null}}()))))})),Y=function(){var t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},t(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),X=["context"],tt=(0,p.vU)({title:{id:"column.notifications",defaultMessage:"Notifications"},queue:{id:"notifications.queue_label",defaultMessage:"Click to see {count} new {count, plural, one {notification} other {notifications}}"}}),et=function(t){return t.context.hasMore?(0,c.Z)(j,{}):null},ot=function(t){t.context;var e=(0,r.Z)(t,X);return d.createElement("div",(0,s.Z)({className:"border-solid border-b border-gray-200 dark:border-slate-700"},e))},nt=(0,Z.P1)([function(t){return(0,y.Gw)(t).getIn(["notifications","quickFilter","show"])},function(t){return(0,y.Gw)(t).getIn(["notifications","quickFilter","active"])},function(t){return(0,f.List)((0,y.Gw)(t).getIn(["notifications","shows"]).filter((function(t){return!t})).keys())},function(t){return t.getIn(["notifications","items"]).toList()}],(function(t,e,o,n){return t&&"all"!==e?n.filter((function(t){return null!==t&&e===t.get("type")})):n.filterNot((function(t){return null!==t&&o.includes(t.get("type"))}))})),it=(0,g.$j)((function(t){return{showFilterBar:(0,y.Gw)(t).getIn(["notifications","quickFilter","show"]),notifications:nt(t),isLoading:t.getIn(["notifications","isLoading"],!0),isUnread:t.getIn(["notifications","unread"])>0,hasMore:t.getIn(["notifications","hasMore"]),totalQueuedNotificationsCount:t.getIn(["notifications","totalQueuedNotificationsCount"],0)}}))($=(0,m.ZP)($=function(t){function e(){var e=t.apply(this,arguments)||this;return(0,a.Z)(e,"handleLoadGap",(function(t){e.props.dispatch((0,k._P)({maxId:t}))})),(0,a.Z)(e,"handleLoadOlder",u()((function(){var t=e.props.notifications.last();e.props.dispatch((0,k._P)({maxId:t&&t.get("id")}))}),300,{leading:!0})),(0,a.Z)(e,"handleScrollToTop",u()((function(){e.props.dispatch((0,k.ws)(!0))}),100)),(0,a.Z)(e,"handleScroll",u()((function(){e.props.dispatch((0,k.ws)(!1))}),100)),(0,a.Z)(e,"setColumnRef",(function(t){e.column=t})),(0,a.Z)(e,"handleMoveUp",(function(t){var o=e.props.notifications.findIndex((function(e){return null!==e&&e.get("id")===t}))-1;e._selectChild(o,!0)})),(0,a.Z)(e,"handleMoveDown",(function(t){var o=e.props.notifications.findIndex((function(e){return null!==e&&e.get("id")===t}))+1;e._selectChild(o,!1)})),(0,a.Z)(e,"handleDequeueNotifications",(function(){e.props.dispatch((0,k.JI)())})),(0,a.Z)(e,"handleRefresh",(function(){return(0,e.props.dispatch)((0,k._P)())})),e}return Y(e,t),e.prototype.componentWillUnmount=function(){this.handleLoadOlder.cancel(),this.handleScrollToTop.cancel(),this.handleScroll.cancel(),this.props.dispatch((0,k.ws)(!1))},e.prototype.componentDidMount=function(){this.handleDequeueNotifications(),this.props.dispatch((0,k.ws)(!0))},e.prototype._selectChild=function(t,e){var o=this.column,n=o.querySelector("article:nth-of-type(".concat(t+1,") .focusable"));n&&(e&&o.scrollTop>n.offsetTop?n.scrollIntoView(!0):!e&&o.scrollTop+o.clientHeight<n.offsetTop+n.offsetHeight&&n.scrollIntoView(!1),n.focus())},e.prototype.render=function(){var t=this,e=this.props,o=e.intl,n=e.notifications,i=e.isLoading,a=e.hasMore,s=e.showFilterBar,r=e.totalQueuedNotificationsCount,l=(0,c.Z)(h.Z,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. Interact with others to start the conversation."}),u=s?(0,c.Z)(L,{}):null,f=i&&!n||n.isEmpty(),p=(0,c.Z)(M.Z,{onRefresh:this.handleRefresh},void 0,(0,c.Z)(v.OO,{useWindowScroll:!0,data:f?Array(20).fill():n.toArray(),startReached:this.handleScrollToTop,endReached:this.handleLoadOlder,isScrolling:function(e){return e&&t.handleScroll()},itemContent:function(e,o){return f?(0,c.Z)(j,{}):(0,c.Z)(J,{notification:o,onMoveUp:t.handleMoveUp,onMoveDown:t.handleMoveDown},o.id)},context:{hasMore:a},components:{ScrollSeekPlaceholder:j,Footer:et,EmptyPlaceholder:function(){return(0,c.Z)(N.xv,{},void 0,l)},Item:ot}}));return d.createElement(N.sg,{ref:this.setColumnRef,label:o.formatMessage(tt.title),withHeader:!1},u,(0,c.Z)(C.Z,{onClick:this.handleDequeueNotifications,count:r,message:tt.queue}),p)},e}(d.PureComponent))||$)||$},1335:function(t,e,o){t.exports=o.p+"packs/icons/bell-ringing-9f8debf5.svg"},1333:function(t,e,o){t.exports=o.p+"packs/icons/mood-smile-86d732ef.svg"},1332:function(t,e,o){t.exports=o.p+"packs/icons/thumb-up-3d82a705.svg"},1334:function(t,e,o){t.exports=o.p+"packs/icons/repeat-4a725855.svg"}}]);
//# sourceMappingURL=notifications-10ba9d3f539ad270c028.chunk.js.map